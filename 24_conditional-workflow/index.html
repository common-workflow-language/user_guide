
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Conditional workflows &#8212; Common Workflow Language User Guide 0.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extras" href="../extras.html" />
    <link rel="prev" title="Scattering Workflows" href="../23-scatter-workflow/index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    
      
      <link rel="icon" sizes="16x16" href="../_static/images/favicons/cwl/favicon-16x16.png">
      
    
      
      <link rel="icon" sizes="32x32" href="../_static/images/favicons/cwl/favicon-32x32.png">
      
    
      
      <link rel="icon" sizes="96x96" href="../_static/images/favicons/cwl/favicon-96x96.png">
      
    
      
      <link rel="icon" sizes="128x128" href="../_static/images/favicons/cwl/favicon-128.png">
      
    
      
      <link rel="icon" sizes="196x196" href="../_static/images/favicons/cwl/favicon-196x196.png">
      
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/CWL-Logo-HD-cropped2.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../CODE_OF_CONDUCT.html">
  Code of Conduct
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../setup.html">
  Setup
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../episodes.html">
  Episodes
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../extras.html">
  Extras
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../LICENSE.html">
  Licenses
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links d-none d-md-block" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01-introduction/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-1st-example/index.html">
   First Example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-input/index.html">
   Essential Input Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04-output/index.html">
   Returning Output Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05-stdout/index.html">
   Capturing Standard Output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-params/index.html">
   Parameter References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-containers/index.html">
   Running Tools Inside Docker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08-arguments/index.html">
   Additional Arguments and Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09-array-inputs/index.html">
   Array Inputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10-array-outputs/index.html">
   Array Outputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11-records/index.html">
   Advanced Inputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../12-env/index.html">
   Environment Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../13-expressions/index.html">
   JavaScript Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../14-runtime/index.html">
   Creating Files at Runtime
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../15-staging/index.html">
   Staging Input Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../16-file-formats/index.html">
   File Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../17-metadata/index.html">
   Metadata and Authorship
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../19-custom-types/index.html">
   Custom Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../20-software-requirements/index.html">
   Specifying Software Requirements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../21-1st-workflow/index.html">
   Writing Workflows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../22-nested-workflows/index.html">
   Nested Workflows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../23-scatter-workflow/index.html">
   Scattering Workflows
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Conditional workflows
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/common-workflow-language/user_guide/edit/gh-pages/24_conditional-workflow/index.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="conditional-workflows">
<h1>Conditional workflows<a class="headerlink" href="#conditional-workflows" title="Permalink to this headline">#</a></h1>
<p>This workflow contains a conditional step and is executed based on the input.
This allows workflows to skip additional steps based on input parameters given at the start of the program or by previous steps.</p>
<p><em>conditional-workflow.cwl</em></p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span><span class="w"></span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span><span class="w"></span>
<span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span><span class="w"></span>

<span class="nt">steps</span><span class="p">:</span><span class="w"></span>

<span class="w">  </span><span class="nt">step1</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">in1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span><span class="w"></span>
<span class="w">      </span><span class="nt">a_new_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span><span class="w"></span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo.cwl</span><span class="w"></span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(inputs.in1 &lt; 1)</span><span class="w"></span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out1</span><span class="p p-Indicator">]</span><span class="w"></span>

<span class="w">  </span><span class="nt">step2</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">in1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span><span class="w"></span>
<span class="w">      </span><span class="nt">a_new_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span><span class="w"></span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo.cwl</span><span class="w"></span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(inputs.a_new_var &gt; 2)</span><span class="w"></span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out1</span><span class="p p-Indicator">]</span><span class="w"></span>

<span class="nt">outputs</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">out1</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step1/out1</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step2/out1</span><span class="w"></span>
<span class="w">    </span><span class="nt">pickValue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">first_non_null</span><span class="w"></span>

<span class="nt">requirements</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">InlineJavascriptRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">  </span><span class="nt">MultipleInputFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
</pre></div>
</div>
<p>The first thing youâ€™ll notice is that this workflow is only compatible for version 1.2 or greater of the CWL standards.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span><span class="w"></span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span><span class="w"></span>
</pre></div>
</div>
<p>The first step of the worklfow (step1) contains two input properties and will execute foo.cwl when the conditions are met. The new property <code class="docutils literal notranslate"><span class="pre">when</span></code> is where the condition validation takes place. In this case only when <code class="docutils literal notranslate"><span class="pre">in1</span></code>  from the workflow contains a value <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">1</span></code> this step will be executed.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span><span class="w"></span>

<span class="w">  </span><span class="nt">step1</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">in1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span><span class="w"></span>
<span class="w">      </span><span class="nt">a_new_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span><span class="w"></span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo.cwl</span><span class="w"></span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(inputs.in1 &lt; 1)</span><span class="w"></span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out1</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
<p>Using the following command <code class="docutils literal notranslate"><span class="pre">cwltool</span> <span class="pre">cond-wf-003.1.cwl</span> <span class="pre">--val</span> <span class="pre">0</span></code> the value will pass the first conditional step and will therefor be executed and is shown in the log by <code class="docutils literal notranslate"><span class="pre">INFO</span> <span class="pre">[step</span> <span class="pre">step1]</span> <span class="pre">start</span></code> whereas the second step is skipped as indicated by <code class="docutils literal notranslate"><span class="pre">INFO</span> <span class="pre">[step</span> <span class="pre">step2]</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">skipped</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>INFO <span class="o">[</span>workflow <span class="o">]</span> start
INFO <span class="o">[</span>workflow <span class="o">]</span> starting step step1
INFO <span class="o">[</span>step step1<span class="o">]</span> start
INFO <span class="o">[</span>job step1<span class="o">]</span> /private/tmp/docker_tmpdcyoto2d$ <span class="nb">echo</span>

INFO <span class="o">[</span>job step1<span class="o">]</span> completed success
INFO <span class="o">[</span>step step1<span class="o">]</span> completed success
INFO <span class="o">[</span>workflow <span class="o">]</span> starting step step2
INFO <span class="o">[</span>step step2<span class="o">]</span> will be skipped
INFO <span class="o">[</span>step step2<span class="o">]</span> completed skipped
INFO <span class="o">[</span>workflow <span class="o">]</span> completed success
<span class="o">{</span>
    <span class="s2">&quot;out1&quot;</span>: <span class="s2">&quot;foo 0&quot;</span>
<span class="o">}</span>
INFO Final process status is success
</pre></div>
</div>
<p>When a value of 3 is given the first conditional step will not be executed but the second step will <code class="docutils literal notranslate"><span class="pre">cwltool</span> <span class="pre">cond-wf-003.1.cwl</span> <span class="pre">--val</span> <span class="pre">3</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>INFO <span class="o">[</span>workflow <span class="o">]</span> start
INFO <span class="o">[</span>workflow <span class="o">]</span> starting step step1
INFO <span class="o">[</span>step step1<span class="o">]</span> will be skipped
INFO <span class="o">[</span>step step1<span class="o">]</span> completed skipped
INFO <span class="o">[</span>workflow <span class="o">]</span> starting step step2
INFO <span class="o">[</span>step step2<span class="o">]</span> start
INFO <span class="o">[</span>job step2<span class="o">]</span> /private/tmp/docker_tmpqwr93mxx$ <span class="nb">echo</span>

INFO <span class="o">[</span>job step2<span class="o">]</span> completed success
INFO <span class="o">[</span>step step2<span class="o">]</span> completed success
INFO <span class="o">[</span>workflow <span class="o">]</span> completed success
<span class="o">{</span>
    <span class="s2">&quot;out1&quot;</span>: <span class="s2">&quot;foo 3&quot;</span>
<span class="o">}</span>
INFO Final process status is success
</pre></div>
</div>
<p>If no conditions are met for example when using <code class="docutils literal notranslate"><span class="pre">--val</span> <span class="pre">2</span></code> the workflow will raise a permanentFail.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cwltool cond-wf-003.1.cwl --val <span class="m">2</span>

INFO <span class="o">[</span>workflow <span class="o">]</span> start
INFO <span class="o">[</span>workflow <span class="o">]</span> starting step step1
INFO <span class="o">[</span>step step1<span class="o">]</span> will be skipped
INFO <span class="o">[</span>step step1<span class="o">]</span> completed skipped
INFO <span class="o">[</span>workflow <span class="o">]</span> starting step step2
INFO <span class="o">[</span>step step2<span class="o">]</span> will be skipped
INFO <span class="o">[</span>step step2<span class="o">]</span> completed skipped
ERROR <span class="o">[</span>workflow <span class="o">]</span> Cannot collect workflow output: All sources <span class="k">for</span> <span class="s1">&#39;out1&#39;</span> are null
INFO <span class="o">[</span>workflow <span class="o">]</span> completed permanentFail
WARNING Final process status is permanentFail
</pre></div>
</div>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../23-scatter-workflow/index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Scattering Workflows</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../extras.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Extras</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>

<div class="container">
  <div class="row">
    <div class="col d-flex flex-row-reverse">
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/">Source</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/blob/gh-pages/CITATION">Cite</a>
        </li>
      </ul>
    </div>
  </div>
</div>

<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2013, CWL Project Team.<br>
</p>
    </div>
    
  </div>
</footer>

  </body>
</html>