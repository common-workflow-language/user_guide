
<!DOCTYPE html>


<html lang="zh-Hans" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" sizes="16x16" href="../_static/images/favicons/cwl/favicon-16x16.png" type="image/png">
    <link rel="icon" sizes="32x32" href="../_static/images/favicons/cwl/favicon-32x32.png" type="image/png">
    <link rel="icon" sizes="96x96" href="../_static/images/favicons/cwl/favicon-96x96.png" type="image/png">
    <link rel="icon" sizes="128x128" href="../_static/images/favicons/cwl/favicon-128.png" type="image/png">
    <link rel="icon" sizes="196x196" href="../_static/images/favicons/cwl/favicon-196x196.png" type="image/png">
    <title>2.10. 工作流 &#8212; Common Workflow Language User Guide 0.1 文档</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=e0da1575" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=ac4875c4"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'topics/workflows';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="2.11. 抽象操作" href="operations.html" />
    <link rel="prev" title="2.9. 表达式工具" href="expression-tool.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="zh-Hans"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/CWL-Logo-HD-cropped2.png" class="logo__image only-light" alt="Common Workflow Language User Guide 0.1 文档 - Home"/>
    <script>document.write(`<img src="../_static/CWL-Logo-HD-cropped2.png" class="logo__image only-dark" alt="Common Workflow Language User Guide 0.1 文档 - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../introduction/index.html">
                        概述
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        主题
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorials.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        常见问题
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../LICENSE.html">
                        许可协议
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.commonwl.org/community/">
                    Community
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">搜索</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/common-workflow-language/user_guide/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">搜索</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../introduction/index.html">
                        概述
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        主题
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorials.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        常见问题
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../LICENSE.html">
                        许可协议
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.commonwl.org/community/">
                    Community
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/common-workflow-language/user_guide/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="章节导航">
  <p class="bd-links__title" role="heading" aria-level="1">章节导航</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="yaml-guide.html">2.1. YAML Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-line-tool.html">2.2. 命令行工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">2.3. 表达式</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">2.4. 输入 (inputs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-arguments-and-parameters.html">2.5. 附加参数</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter-references.html">2.6. 参数引用</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">2.7. 输出</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-types.html">2.8. 自定义类型</a></li>
<li class="toctree-l1"><a class="reference internal" href="expression-tool.html">2.9. 表达式工具</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2.10. 工作流</a></li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">2.11. 抽象操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment-variables.html">2.12. 环境变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-containers.html">2.13. 使用容器</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating-files-at-runtime.html">2.14. 在运行时创建文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="staging-input-files.html">2.15. 暂存输入文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="best-practices.html">2.16. 优良习惯</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-formats.html">2.17. 文件格式</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata-and-authorship.html">2.18. 元数据和著作人信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="specifying-software-requirements.html">2.19. 指定软件需求</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">2.20. 故障排除</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link"><span class="section-number">2. </span>主题</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="workflows">
<h1><span class="section-number">2.10. </span>工作流<a class="headerlink" href="#workflows" title="Link to this heading">#</a></h1>
<p>工作流 (workflow) 指的是将命令行工具、表达式工具或（子）工作流等作为步骤进行执行的 CWL 处理单元。一个工作流必须具备 CWL 程序所定义的 <code class="docutils literal notranslate"><span class="pre">inputs</span></code>（输入）, <code class="docutils literal notranslate"><span class="pre">outputs</span></code>（输出）, 以及 <code class="docutils literal notranslate"><span class="pre">step</span></code>（步骤）.</p>
<figure class="align-center" id="id1">
<div class="graphviz"><object data="../_images/graphviz-31e64e790986643ef2b3f5e6bc28d3d39838e9be.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph G {
    compound=true;
    rankdir=&quot;LR&quot;;
    fontname=&quot;Verdana&quot;;
    fontsize=&quot;10&quot;;
    graph [splines=ortho];

    node [fontname=&quot;Verdana&quot;, fontsize=&quot;10&quot;, shape=box];
    edge [fontname=&quot;Verdana&quot;, fontsize=&quot;10&quot;];

    subgraph cluster_0 {
      node [width = 1.75];
      steps_0[style=&quot;filled&quot; label=&quot;Command-line tools&quot;];
      steps_1[style=&quot;filled&quot; label=&quot;Expression tools&quot;];
      steps_2[style=&quot;filled&quot; label=&quot;Sub-workflows&quot;];
      label=&quot;steps&quot;;
      fill=gray;
    }

    inputs -&gt; steps_1 [lhead=cluster_0];
    steps_1 -&gt; outputs [ltail=cluster_0];
}</p></object></div>
<figcaption>
<p><span class="caption-text">CWL 工作流</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>CWL 文件 <code class="docutils literal notranslate"><span class="pre">echo-uppercase.cwl</span></code> 定义了之前的例子中运行命令行工具的工作流以及表达式工具。</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">echo-uppercase.cwl</span></code></span><a class="headerlink" href="#id2" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">InlineJavascriptRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">out</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uppercase/uppercase_message</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">uppercase</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uppercase.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span>
<span class="w">        </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo/out</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">uppercase_message</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<p>命令行工具或表达式工具亦可直接写在定义工作流的单一 CWL 文件里。例如，我们可以将 <code class="docutils literal notranslate"><span class="pre">echo-uppercase.cwl</span></code> 改写成一个单独的文件如下：</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">echo-uppercase-single-file.cwl</span></code></span><a class="headerlink" href="#id3" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">InlineJavascriptRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">out</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uppercase/uppercase_message</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CommandLineTool</span>

<span class="w">      </span><span class="nt">baseCommand</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo</span>

<span class="w">      </span><span class="nt">stdout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output.txt</span>

<span class="w">      </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">message</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">          </span><span class="nt">inputBinding</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">      </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">out</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">          </span><span class="nt">outputBinding</span><span class="p">:</span>
<span class="w">            </span><span class="nt">glob</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output.txt</span>
<span class="w">            </span><span class="nt">loadContents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="nt">outputEval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(self[0].contents)</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">uppercase</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExpressionTool</span>

<span class="w">      </span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">        </span><span class="nt">InlineJavascriptRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="w">      </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">uppercase_message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>

<span class="w">      </span><span class="nt">expression</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">${ return {&quot;uppercase_message&quot;: inputs.message.toUpperCase()}; }</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span>
<span class="w">        </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo/out</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">uppercase_message</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<p>将代码分为多个独立的文件有助于模块化和代码的组织条理。不过，把全部代码集中在一个文件，可能对开发更有利。将多个文件整合为一个，还有其他手段（如 <code class="docutils literal notranslate"><span class="pre">cwltool</span> <span class="pre">--pack</span></code>），将在本《指南》的其他章节进一步讨论。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>子工作流 (sub-workflow) 需要启用 <code class="docutils literal notranslate"><span class="pre">SubworkflowFeatureRequirement</span></code> 这一要求，这在另一章节中将有更详细的教程。</p>
</div>
<section id="writing-workflows">
<h2><span class="section-number">2.10.1. </span>编写工作流<a class="headerlink" href="#writing-workflows" title="Link to this heading">#</a></h2>
<p>这个工作流从 tar 文件中提取一个 Java 源文件，然后编译。</p>
<div class="literal-block-wrapper docutils container" id="st-workflow-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">1st-workflow.cwl</span></code></span><a class="headerlink" href="#st-workflow-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env cwl-runner</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tarball</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">  </span><span class="nt">name_of_file_to_extract</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">compiled_class</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile/classfile</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">untar</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tar-param.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tarfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tarball</span>
<span class="w">      </span><span class="nt">extractfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name_of_file_to_extract</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">extracted_file</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">compile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arguments.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">untar/extracted_file</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">classfile</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="admonition-visualization-of-1st-workflow-cwl admonition">
<p class="admonition-title">1st-workflow.cwl 的图示</p>
<p><a class="reference external" href="https://view.commonwl.org/graph/png/github.com/common-workflow-language/user_guide/blob/a29e7eae0006660946fc705a310b37a21a7e1edc/_includes/cwl/21-1st-workflow/1st-workflow.cwl"><img alt="1st-workflow.cwl 的图示" src="https://view.commonwl.org/graph/png/github.com/common-workflow-language/user_guide/blob/a29e7eae0006660946fc705a310b37a21a7e1edc/_includes/cwl/21-1st-workflow/1st-workflow.cwl" /></a></p>
</div>
<p>在分立的文件中通过 YAML 或 JSON 对象来描述一次运行的输入：</p>
<div class="literal-block-wrapper docutils container" id="st-workflow-job-yml">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">1st-workflow-job.yml</span></code></span><a class="headerlink" href="#st-workflow-job-yml" title="Link to this code">#</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tarball</span><span class="p">:</span>
<span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello.tar</span>
<span class="nt">name_of_file_to_extract</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello.java</span>
</pre></div>
</div>
</div>
<p>接下来，创建一个 Java 文件样本，将其打包到一个 tar 文件，以供运行命令行工具时使用。</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;public class Hello {}&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Hello.java<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>tar<span class="w"> </span>-cvf<span class="w"> </span>hello.tar<span class="w"> </span>Hello.java
<span class="go">Hello.java</span>
</pre></div>
</div>
<p>现在，在命令行上以工具描述和输入对象为参数调用 <code class="docutils literal notranslate"><span class="pre">cwltool</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cwltool<span class="w"> </span>1st-workflow.cwl<span class="w"> </span>1st-workflow-job.yml
INFO<span class="w"> </span>/opt/hostedtoolcache/Python/3.9.19/x64/bin/cwltool<span class="w"> </span><span class="m">3</span>.1.20240508115724
INFO<span class="w"> </span>Resolved<span class="w"> </span><span class="s1">&#39;1st-workflow.cwl&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;file:///home/runner/work/user_guide/user_guide/src/_includes/cwl/workflows/1st-workflow.cwl&#39;</span>
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>starting<span class="w"> </span>step<span class="w"> </span>untar
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>untar<span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>untar<span class="o">]</span><span class="w"> </span>/tmp/k2g_nwxf$<span class="w"> </span>tar<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--extract<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--file<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/tmp/61km9ym3/stg0b0b38b6-2402-4b40-b1f0-6d13b876a0f4/hello.tar<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>Hello.java
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>untar<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>untar<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>starting<span class="w"> </span>step<span class="w"> </span>compile
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>compile<span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>compile<span class="o">]</span><span class="w"> </span>/tmp/40ih0csl$<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-i<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="o">=</span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/tmp/40ih0csl,target<span class="o">=</span>/GekUop<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="o">=</span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/tmp/9v9ot09j,target<span class="o">=</span>/tmp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="o">=</span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/tmp/k2g_nwxf/Hello.java,target<span class="o">=</span>/var/lib/cwl/stge7596ff8-6c0a-45f8-aaaf-6808ce39b270/Hello.java,readonly<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--workdir<span class="o">=</span>/GekUop<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--read-only<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--net<span class="o">=</span>none<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--user<span class="o">=</span><span class="m">1001</span>:127<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidfile<span class="o">=</span>/tmp/669f1n6j/20240518114803-905229.cid<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--env<span class="o">=</span><span class="nv">TMPDIR</span><span class="o">=</span>/tmp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--env<span class="o">=</span><span class="nv">HOME</span><span class="o">=</span>/GekUop<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>openjdk:9.0.1-11-slim<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>javac<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/GekUop<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/var/lib/cwl/stge7596ff8-6c0a-45f8-aaaf-6808ce39b270/Hello.java
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>compile<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>compile<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
<span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;compiled_class&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;location&quot;</span>:<span class="w"> </span><span class="s2">&quot;file:///home/runner/work/user_guide/user_guide/src/_includes/cwl/workflows/Hello.class&quot;</span>,
<span class="w">        </span><span class="s2">&quot;basename&quot;</span>:<span class="w"> </span><span class="s2">&quot;Hello.class&quot;</span>,
<span class="w">        </span><span class="s2">&quot;class&quot;</span>:<span class="w"> </span><span class="s2">&quot;File&quot;</span>,
<span class="w">        </span><span class="s2">&quot;checksum&quot;</span>:<span class="w"> </span><span class="s2">&quot;sha1</span><span class="nv">$39</span><span class="s2">e3219327347c05aa3e82236f83aa6d77fe6bfd&quot;</span>,
<span class="w">        </span><span class="s2">&quot;size&quot;</span>:<span class="w"> </span><span class="m">419</span>,
<span class="w">        </span><span class="s2">&quot;path&quot;</span>:<span class="w"> </span><span class="s2">&quot;/home/runner/work/user_guide/user_guide/src/_includes/cwl/workflows/Hello.class&quot;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>INFO<span class="w"> </span>Final<span class="w"> </span>process<span class="w"> </span>status<span class="w"> </span>is<span class="w"> </span>success
</pre></div>
</div>
<p>这是怎么一回事呢？我们一一道来：</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.0</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cwlVersion</span></code> 字段指明该文件使用的 CWL 规约版本。<code class="docutils literal notranslate"><span class="pre">class</span></code> 字段表明该文件描述的是一个工作流。</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tarball</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">  </span><span class="nt">name_of_file_to_extract</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">inputs</span></code> 代码段描述的是工作流的输入，即一组输入参数。这里面的每个参数都由标识符和数据类型构成，它们可以用作工作流中某个指定步骤的输入源。</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">compiled_class</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile/classfile</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">outputs</span></code> 代码段描述的是工作流的输出。这同样是一组由标识符和数据类型构成的参数。<code class="docutils literal notranslate"><span class="pre">outputSource</span></code> 将 <code class="docutils literal notranslate"><span class="pre">compile</span></code>（编译）步骤的输出参数 <code class="docutils literal notranslate"><span class="pre">classfile</span></code> 同工作流的输出参数 <code class="docutils literal notranslate"><span class="pre">compiled_class</span></code> 建立联系。</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">untar</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tar-param.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tarfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tarball</span>
<span class="w">      </span><span class="nt">extractfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name_of_file_to_extract</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">extracted_file</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">steps</span></code> 代码段描述的是工作流的实际步骤。这个例子中，第一个步骤是从 tar 归档文件中提取一个文件，而第二步是使用 Java 编译器编译来自第一步的文件。工作流的各个步骤不是必须按照在代码中列出的顺序运行，而是由各个步骤之间（由 <code class="docutils literal notranslate"><span class="pre">source</span></code> 决定）的依赖关系确定其先后次序。此外，工作流中没有依赖关系的多个步骤允许并行运行。</p>
<p>第一个步骤 <code class="docutils literal notranslate"><span class="pre">untar</span></code> 运行 <code class="docutils literal notranslate"><span class="pre">tar-param.cwl</span></code>（此前见于<a class="reference internal" href="parameter-references.html"><span class="std std-doc">《参数引用》</span></a>一节）。该工具有两个输入参数 <code class="docutils literal notranslate"><span class="pre">tarfile</span></code> 和 <code class="docutils literal notranslate"><span class="pre">extractfile</span></code>, 以及一个输出参数 <code class="docutils literal notranslate"><span class="pre">extracted_file</span></code>.</p>
<p>该工作流步骤下的 <code class="docutils literal notranslate"><span class="pre">in</span></code> 这段代码将上述两个输入参数同工作流的输入 <code class="docutils literal notranslate"><span class="pre">tarball</span></code> 和 <code class="docutils literal notranslate"><span class="pre">name_of_file_to_extract</span></code> 通过<code class="docutils literal notranslate"><span class="pre">source</span></code> 关联起来。这意味着当这个工作流步骤执行时，为了运行其指定的工具，<code class="docutils literal notranslate"><span class="pre">tarball</span></code> 和 <code class="docutils literal notranslate"><span class="pre">name_of_file_to_extract</span></code> 所赋予的值将用于 <code class="docutils literal notranslate"><span class="pre">tarfile</span></code> 和 <code class="docutils literal notranslate"><span class="pre">extractfile</span></code> 参数。</p>
<p>工作流步骤下的 <code class="docutils literal notranslate"><span class="pre">out</span></code> 代码段列出了预期中从工具应获得的参数。</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">compile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arguments.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">untar/extracted_file</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">classfile</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>第二个步骤 <code class="docutils literal notranslate"><span class="pre">compile</span></code>（编译）依赖于第一步的结果，具体而言它的输入参数 <code class="docutils literal notranslate"><span class="pre">src</span></code> 与 <code class="docutils literal notranslate"><span class="pre">untar</span></code> 步骤的输出参数 <code class="docutils literal notranslate"><span class="pre">untar/extracted_file</span></code> 相关联。这一步骤运行 <code class="docutils literal notranslate"><span class="pre">arguments.cwl</span></code>（此前见于<a class="reference internal" href="additional-arguments-and-parameters.html"><span class="std std-doc">《附加参数》</span></a>一节）。此步骤的输出 <code class="docutils literal notranslate"><span class="pre">classfile</span></code> 关联的是工作流的 <code class="docutils literal notranslate"><span class="pre">outputs</span></code> 部分（见上）。</p>
</section>
<section id="nested-workflows">
<h2><span class="section-number">2.10.2. </span>嵌套的工作流<a class="headerlink" href="#nested-workflows" title="Link to this heading">#</a></h2>
<p>工作流的作用在于将多种工具组合起来，进行更大规模的操作。我们还可以将一个工作流整体视为一个工具；如果工作流引擎支持 <code class="docutils literal notranslate"><span class="pre">SubworkflowFeatureRequirement</span></code>, 则 CWL 工作流可以用作另一 CWL 工作流中的单个步骤：</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">SubworkflowFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
<p>下面这个例子里的工作流嵌入了我们的 <code class="docutils literal notranslate"><span class="pre">1st-workflow.cwl</span></code> 工作流：</p>
<div class="literal-block-wrapper docutils container" id="nestedworkflows-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">nestedworkflows.cwl</span></code></span><a class="headerlink" href="#nestedworkflows-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env cwl-runner</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>

<span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">classout</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile/compiled_class</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">SubworkflowFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">compile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1st-workflow.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tarball</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create-tar/tar_compressed_java_file</span>
<span class="w">      </span><span class="nt">name_of_file_to_extract</span><span class="p">:</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hello.java&quot;</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">compiled_class</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">create-tar</span><span class="p">:</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">tar_compressed_java_file</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CommandLineTool</span>
<span class="w">      </span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">        </span><span class="nt">InitialWorkDirRequirement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">listing</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">entryname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello.java</span>
<span class="w">              </span><span class="nt">entry</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">                </span><span class="no">public class Hello {</span>
<span class="w">                  </span><span class="no">public static void main(String[] argv) {</span>
<span class="w">                      </span><span class="no">System.out.println(&quot;Hello from Java&quot;);</span>
<span class="w">                  </span><span class="no">}</span>
<span class="w">                </span><span class="no">}</span>
<span class="w">      </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">      </span><span class="nt">baseCommand</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">tar</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--create</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--file=hello.tar</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Hello.java</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tar_compressed_java_file</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">          </span><span class="nt">streamable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">outputBinding</span><span class="p">:</span>
<span class="w">            </span><span class="nt">glob</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello.tar&quot;</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p class="rubric">Visualization of the workflow and the inner workflow from its `compile` step</a>
<p>这个由两个步骤构成的工作流，起始于 <code class="docutils literal notranslate"><span class="pre">create-tar</span></code> 步骤，进而接入橙色的 <code class="docutils literal notranslate"><span class="pre">compile</span></code> 步骤；如右侧图所示，<code class="docutils literal notranslate"><span class="pre">compile</span></code> 是另一个工作流。由紫色的部分可见字符串常量 <code class="docutils literal notranslate"><span class="pre">&quot;Hello.java&quot;</span></code> 赋值给 <code class="docutils literal notranslate"><span class="pre">name_of_file_to_extract</span></code>.</p>
<p><a href="https://view.commonwl.org/workflows/github.com/common-workflow-language/user_guide/blob/main/src/_includes/cwl/workflows/nestedworkflows.cwl"><img
src="https://view.commonwl.org/graph/svg/github.com/common-workflow-language/user_guide/blob/main/src/_includes/cwl/workflows/nestedworkflows.cwl"
alt="Visualization of nestedworkflows.cwl" /></a>
<a href="https://view.commonwl.org/workflows/github.com/common-workflow-language/user_guide/blob/main/src/_includes/cwl/workflows/1st-workflow.cwl"><img
src="https://view.commonwl.org/graph/svg/github.com/common-workflow-language/user_guide/blob/main/src/_includes/cwl/workflows/1st-workflow.cwl"
alt="Visualization of 1st-workflow.cwl" /></a></p>
</div>
<p>CWL <code class="docutils literal notranslate"><span class="pre">Workflow</span></code>（工作流）就和 <code class="docutils literal notranslate"><span class="pre">CommandLineTool</span></code>（命令行工具）一样，可以充当一个步骤。通过 <code class="docutils literal notranslate"><span class="pre">run</span></code> 字段可以将其 CWL 文件包含进来。然后，工作流的输入 (<code class="docutils literal notranslate"><span class="pre">tarball</span></code> 和 <code class="docutils literal notranslate"><span class="pre">name_of_file_to_extract</span></code>) 与输出 (<code class="docutils literal notranslate"><span class="pre">compiled_class</span></code>) 就可以映射为这一步骤的输入/输出。</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">compile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1st-workflow.cwl</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tarball</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create-tar/tar_compressed_java_file</span>
<span class="w">      </span><span class="nt">name_of_file_to_extract</span><span class="p">:</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hello.java&quot;</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">compiled_class</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Our <code class="docutils literal notranslate"><span class="pre">1st-workflow.cwl</span></code> was parameterized with workflow inputs, so when running
it we had to provide a job file to denote the tar file and <code class="docutils literal notranslate"><span class="pre">*.java</span></code> filename.
This is generally best-practice, as it means it can be reused in multiple parent
workflows, or even in multiple steps within the same workflow.</p>
<p>Here we use <code class="docutils literal notranslate"><span class="pre">default:</span></code> to hard-code <code class="docutils literal notranslate"><span class="pre">&quot;Hello.java&quot;</span></code> as the <code class="docutils literal notranslate"><span class="pre">name_of_file_to_extract</span></code>
input, however our workflow also requires a tar file at <code class="docutils literal notranslate"><span class="pre">tarball</span></code>, which we will
prepare in the <code class="docutils literal notranslate"><span class="pre">create-tar</span></code> step. At this point it is probably a good idea to refactor
<code class="docutils literal notranslate"><span class="pre">1st-workflow.cwl</span></code> to have more specific input/output names, as those also
appear in its usage as a tool.</p>
<p>It is also possible to do a less generic approach and avoid external
dependencies in the job file. So in this workflow we can generate a hard-coded
<code class="docutils literal notranslate"><span class="pre">Hello.java</span></code> file using the previously mentioned <code class="docutils literal notranslate"><span class="pre">InitialWorkDirRequirement</span></code>
requirement, before adding it to a tar file.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">create-tar</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">      </span><span class="nt">InitialWorkDirRequirement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">listing</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">entryname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello.java</span>
<span class="w">            </span><span class="nt">entry</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">public class Hello {</span>
<span class="w">                </span><span class="no">public static void main(String[] argv) {</span>
<span class="w">                    </span><span class="no">System.out.println(&quot;Hello from Java&quot;);</span>
<span class="w">                </span><span class="no">}</span>
<span class="w">              </span><span class="no">}</span>
</pre></div>
</div>
<p>In this case our step can assume <code class="docutils literal notranslate"><span class="pre">Hello.java</span></code> rather than be parameterized, so
we can use hardcoded values <code class="docutils literal notranslate"><span class="pre">hello.tar</span></code> and <code class="docutils literal notranslate"><span class="pre">Hello.java</span></code> in a <code class="docutils literal notranslate"><span class="pre">baseCommand</span></code> and
the resulting <code class="docutils literal notranslate"><span class="pre">outputs</span></code>:</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<span class="w">    </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CommandLineTool</span>
<span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">baseCommand</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">tar</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--create</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--file=hello.tar</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Hello.java</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tar_compressed_java_file</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">        </span><span class="nt">streamable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">outputBinding</span><span class="p">:</span>
<span class="w">          </span><span class="nt">glob</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello.tar&quot;</span>
</pre></div>
</div>
<p>Did you notice that we didn't split out the <code class="docutils literal notranslate"><span class="pre">tar</span> <span class="pre">--create</span></code> tool to a separate file,
but rather embedded it within the CWL Workflow file? This is generally not best
practice, as the tool then can't be reused. The reason for doing it in this case
is because the command line is hard-coded with filenames that only make sense
within this workflow.</p>
<p>In this example we had to prepare a tar file outside, but only because our inner
workflow was designed to take that as an input. A better refactoring of the
inner workflow would be to take a list of Java files to compile, which would
simplify its usage as a tool step in other workflows.</p>
<p>Nested workflows can be a powerful feature to generate higher-level functional
and reusable workflow units - but just like for creating a CWL Tool description,
care must be taken to improve its usability in multiple workflows.</p>
</section>
<section id="scattering-steps">
<h2><span class="section-number">2.10.3. </span>Scattering Steps<a class="headerlink" href="#scattering-steps" title="Link to this heading">#</a></h2>
<p>Now that we know how to write workflows, we can start utilizing the <code class="docutils literal notranslate"><span class="pre">ScatterFeatureRequirement</span></code>.
This feature tells the runner that you wish to run a tool or workflow multiple times over a list
of inputs. The workflow then takes the input(s) as an array and will run the specified step(s)
on each element of the array as if it were a single input. This allows you to run the same workflow
on multiple inputs without having to generate many different commands or input yaml files.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ScatterFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
<p>The most common reason a new user might want to use scatter is to perform the same analysis on
different samples. Let's start with a simple workflow that calls our first example
(<code class="docutils literal notranslate"><span class="pre">hello_world.cwl</span></code>) and takes an array of strings as input to the workflow:</p>
<div class="literal-block-wrapper docutils container" id="scatter-workflow-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">scatter-workflow.cwl</span></code></span><a class="headerlink" href="#scatter-workflow-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env cwl-runner</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ScatterFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">message_array</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string[]</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello_world.cwl</span>
<span class="w">    </span><span class="nt">scatter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message_array</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>

<span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</div>
<p>Aside from the <code class="docutils literal notranslate"><span class="pre">requirements</span></code> section including <code class="docutils literal notranslate"><span class="pre">ScatterFeatureRequirement</span></code>, what is
going on here?</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">message_array</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string[]</span>
</pre></div>
</div>
<p>First of all, notice that the main workflow level input here requires an array of strings.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello_world.cwl</span>
<span class="w">    </span><span class="nt">scatter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message_array</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
<p>Here we've added a new field to the step <code class="docutils literal notranslate"><span class="pre">echo</span></code> called <code class="docutils literal notranslate"><span class="pre">scatter</span></code>. This field tells the
runner that we'd like to scatter over this input for this particular step. Note that
the input name listed after scatter is the one of the step's input, not a workflow level input.</p>
<p>For our first scatter, it's as simple as that! Since our tool doesn't collect any outputs, we
still use <code class="docutils literal notranslate"><span class="pre">outputs:</span> <span class="pre">[]</span></code> in our workflow, but if you expect that the final output of your
workflow will now have multiple outputs to collect, be sure to update that to an array type
as well!</p>
<p>Using the following input file:</p>
<div class="literal-block-wrapper docutils container" id="scatter-job-yml">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">scatter-job.yml</span></code></span><a class="headerlink" href="#scatter-job-yml" title="Link to this code">#</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">message_array</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello world!</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hola mundo!</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bonjour le monde!</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hallo welt!</span>
</pre></div>
</div>
</div>
<p>As a reminder, <a class="reference internal" href="../introduction/quick-start.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">hello_world.cwl</span></code></span></a> simply calls the command
<code class="docutils literal notranslate"><span class="pre">echo</span></code> on a message. If we invoke <code class="docutils literal notranslate"><span class="pre">cwltool</span> <span class="pre">scatter-workflow.cwl</span> <span class="pre">scatter-job.yml</span></code> on the
command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cwltool<span class="w"> </span>scatter-workflow.cwl<span class="w"> </span>scatter-job.yml
INFO<span class="w"> </span>/opt/hostedtoolcache/Python/3.9.19/x64/bin/cwltool<span class="w"> </span><span class="m">3</span>.1.20240508115724
INFO<span class="w"> </span>Resolved<span class="w"> </span><span class="s1">&#39;scatter-workflow.cwl&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;file:///home/runner/work/user_guide/user_guide/src/_includes/cwl/workflows/scatter-workflow.cwl&#39;</span>
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>starting<span class="w"> </span>step<span class="w"> </span><span class="nb">echo</span>
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>/tmp/lcigk_ao$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s1">&#39;Hello world!&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/lcigk_ao/4e58fa7cfe8505476c857c252be2f391ddbf1187
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo_2<span class="o">]</span><span class="w"> </span>/tmp/e4ey7f65$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s1">&#39;Hola mundo!&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/e4ey7f65/4e58fa7cfe8505476c857c252be2f391ddbf1187
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo_2<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo_3<span class="o">]</span><span class="w"> </span>/tmp/uel4a9mt$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s1">&#39;Bonjour le monde!&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/uel4a9mt/4e58fa7cfe8505476c857c252be2f391ddbf1187
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo_3<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>start
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo_4<span class="o">]</span><span class="w"> </span>/tmp/8ry9mfkz$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s1">&#39;Hallo welt!&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/8ry9mfkz/4e58fa7cfe8505476c857c252be2f391ddbf1187
INFO<span class="w"> </span><span class="o">[</span>job<span class="w"> </span>echo_4<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>step<span class="w"> </span>echo<span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
INFO<span class="w"> </span><span class="o">[</span>workflow<span class="w"> </span><span class="o">]</span><span class="w"> </span>completed<span class="w"> </span>success
<span class="o">{}</span>INFO<span class="w"> </span>Final<span class="w"> </span>process<span class="w"> </span>status<span class="w"> </span>is<span class="w"> </span>success
</pre></div>
</div>
<p>You can see that the workflow calls echo multiple times on each element of our
<code class="docutils literal notranslate"><span class="pre">message_array</span></code>. Ok, so how about if we want to scatter over two steps in a workflow?</p>
<p>Let's perform a simple echo like above, but capturing <code class="docutils literal notranslate"><span class="pre">stdout</span></code> by adding the following
lines instead of <code class="docutils literal notranslate"><span class="pre">outputs:</span> <span class="pre">[]</span></code></p>
<div class="literal-block-wrapper docutils container" id="hello-world-to-stdout-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">hello_world_to_stdout.cwl</span></code></span><a class="headerlink" href="#hello-world-to-stdout-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo_out</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stdout</span>
</pre></div>
</div>
</div>
<p>And add a second step that uses <code class="docutils literal notranslate"><span class="pre">wc</span></code> to count the characters in each file. See the tool
below:</p>
<div class="literal-block-wrapper docutils container" id="wc-tool-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">wc-tool.cwl</span></code></span><a class="headerlink" href="#wc-tool-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env cwl-runner</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CommandLineTool</span>
<span class="nt">baseCommand</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wc</span>
<span class="nt">arguments</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">    </span><span class="nt">inputBinding</span><span class="p">:</span>
<span class="w">      </span><span class="nt">position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</div>
<p>Now, how do we incorporate scatter? Remember the scatter field is under each step:</p>
<div class="literal-block-wrapper docutils container" id="scatter-two-steps-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">scatter-two-steps.cwl</span></code></span><a class="headerlink" href="#scatter-two-steps-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env cwl-runner</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w"> </span><span class="nt">ScatterFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">message_array</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string[]</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello_world_to_stdout.cwl</span>
<span class="w">    </span><span class="nt">scatter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message_array</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">echo_out</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">wc</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wc-tool.cwl</span>
<span class="w">    </span><span class="nt">scatter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input_file</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">input_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo/echo_out</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>

<span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</div>
<p>Here we have placed the scatter field under each step. This is fine for this example since
it runs quickly, but if you're running many samples for a more complex workflow, you may
wish to consider an alternative. Here we are running scatter on each step independently, but
since the second step is not dependent on the first step completing all languages, we aren't
using the scatter functionality efficiently. The second step expects an array as input from
the first step, so it will wait until everything in step one is finished before doing anything.
Pretend that <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">Hello</span> <span class="pre">World!</span></code> takes 1 minute to perform, <code class="docutils literal notranslate"><span class="pre">wc</span> <span class="pre">-c</span></code> on the output takes 3 minutes
and that <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">Hallo</span> <span class="pre">welt!</span></code> takes 5 minutes to perform, and <code class="docutils literal notranslate"><span class="pre">wc</span></code> on that output takes 3 minutes.
Even though <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">Hello</span> <span class="pre">World!</span></code> could finish in 4 minutes, it will actually finish in 8 minutes
because the first step must wait on <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">Hallo</span> <span class="pre">welt!</span></code>. You can see how this might not scale
well.</p>
<p>Ok, so how do we scatter on steps that can proceed independent of other samples? Remember from
<a class="reference external" href="#nested-workflows">Nested Workflows</a>, that we can make an entire workflow a single step in another workflow! Convert our
two-step workflow to a single step subworkflow:</p>
<div class="literal-block-wrapper docutils container" id="scatter-nested-workflow-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">scatter-nested-workflow.cwl</span></code></span><a class="headerlink" href="#scatter-nested-workflow-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env cwl-runner</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w"> </span><span class="nt">ScatterFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w"> </span><span class="nt">SubworkflowFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">message_array</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string[]</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">subworkflow</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="w">      </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">      </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">        </span><span class="nt">echo</span><span class="p">:</span>
<span class="w">          </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello_world_to_stdout.cwl</span>
<span class="w">          </span><span class="nt">in</span><span class="p">:</span>
<span class="w">            </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">          </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">echo_out</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">wc</span><span class="p">:</span>
<span class="w">          </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wc-tool.cwl</span>
<span class="w">          </span><span class="nt">in</span><span class="p">:</span>
<span class="w">            </span><span class="nt">input_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo/echo_out</span>
<span class="w">          </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">scatter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message_array</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</div>
<p>Now the scatter acts on a single step, but that step consists of two steps so each step is performed
in parallel.</p>
</section>
<section id="conditional-workflows">
<h2><span class="section-number">2.10.4. </span>Conditional Workflows<a class="headerlink" href="#conditional-workflows" title="Link to this heading">#</a></h2>
<p>This workflow contains a conditional step and is executed based on the input.
This allows workflows to skip additional steps based on input parameters given at the start of the program or by previous steps.</p>
<div class="literal-block-wrapper docutils container" id="conditional-workflow-cwl">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">conditional-workflow.cwl</span></code></span><a class="headerlink" href="#conditional-workflow-cwl" title="Link to this code">#</a></div>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
<span class="nt">inputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>

<span class="nt">steps</span><span class="p">:</span>

<span class="w">  </span><span class="nt">step1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span>
<span class="w">      </span><span class="nt">a_new_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo.cwl</span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(inputs.in1 &lt; 1)</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out1</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">step2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span>
<span class="w">      </span><span class="nt">a_new_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo.cwl</span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(inputs.a_new_var &gt; 2)</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out1</span><span class="p p-Indicator">]</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">out1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">    </span><span class="nt">outputSource</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step1/out1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step2/out1</span>
<span class="w">    </span><span class="nt">pickValue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">first_non_null</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">InlineJavascriptRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">  </span><span class="nt">MultipleInputFeatureRequirement</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</div>
<p>The first thing you'll notice is that this workflow is only compatible for version 1.2 or greater of the CWL standards.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">cwlVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.2</span>
</pre></div>
</div>
<p>The first step of the workflow (step1) contains two input properties and will execute foo.cwl when the conditions are met. The new property <code class="docutils literal notranslate"><span class="pre">when</span></code> is where the condition validation takes place. In this case only when <code class="docutils literal notranslate"><span class="pre">in1</span></code>  from the workflow contains a value <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">1</span></code> this step will be executed.</p>
<div class="highlight-cwl notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>

<span class="w">  </span><span class="nt">step1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">in</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span>
<span class="w">      </span><span class="nt">a_new_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo.cwl</span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(inputs.in1 &lt; 1)</span>
<span class="w">    </span><span class="nt">out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">out1</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Using the following command <code class="docutils literal notranslate"><span class="pre">cwltool</span> <span class="pre">cond-wf-003.1.cwl</span> <span class="pre">--val</span> <span class="pre">0</span></code> the value will pass the first conditional step and will therefore be executed and is shown in the log by <code class="docutils literal notranslate"><span class="pre">INFO</span> <span class="pre">[step</span> <span class="pre">step1]</span> <span class="pre">start</span></code> whereas the second step is skipped as indicated by <code class="docutils literal notranslate"><span class="pre">INFO</span> <span class="pre">[step</span> <span class="pre">step2]</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">skipped</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">INFO [workflow ] start</span>
<span class="go">INFO [workflow ] starting step step1</span>
<span class="go">INFO [step step1] start</span>
<span class="go">INFO [job step1] /private/tmp/docker_tmpdcyoto2d$ echo</span>

<span class="go">INFO [job step1] completed success</span>
<span class="go">INFO [step step1] completed success</span>
<span class="go">INFO [workflow ] starting step step2</span>
<span class="go">INFO [step step2] will be skipped</span>
<span class="go">INFO [step step2] completed skipped</span>
<span class="go">INFO [workflow ] completed success</span>
<span class="go">{</span>
<span class="go">    &quot;out1&quot;: &quot;foo 0&quot;</span>
<span class="go">}</span>
<span class="go">INFO Final process status is success</span>
</pre></div>
</div>
<p>When a value of 3 is given the first conditional step will not be executed but the second step will <code class="docutils literal notranslate"><span class="pre">cwltool</span> <span class="pre">cond-wf-003.1.cwl</span> <span class="pre">--val</span> <span class="pre">3</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">INFO [workflow ] start</span>
<span class="go">INFO [workflow ] starting step step1</span>
<span class="go">INFO [step step1] will be skipped</span>
<span class="go">INFO [step step1] completed skipped</span>
<span class="go">INFO [workflow ] starting step step2</span>
<span class="go">INFO [step step2] start</span>
<span class="go">INFO [job step2] /private/tmp/docker_tmpqwr93mxx$ echo</span>

<span class="go">INFO [job step2] completed success</span>
<span class="go">INFO [step step2] completed success</span>
<span class="go">INFO [workflow ] completed success</span>
<span class="go">{</span>
<span class="go">    &quot;out1&quot;: &quot;foo 3&quot;</span>
<span class="go">}</span>
<span class="go">INFO Final process status is success</span>
</pre></div>
</div>
<p>If no conditions are met for example when using <code class="docutils literal notranslate"><span class="pre">--val</span> <span class="pre">2</span></code> the workflow will raise a permanentFail.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cwltool<span class="w"> </span>cond-wf-003.1.cwl<span class="w"> </span>--val<span class="w"> </span><span class="m">2</span>

<span class="go">INFO [workflow ] start</span>
<span class="go">INFO [workflow ] starting step step1</span>
<span class="go">INFO [step step1] will be skipped</span>
<span class="go">INFO [step step1] completed skipped</span>
<span class="go">INFO [workflow ] starting step step2</span>
<span class="go">INFO [step step2] will be skipped</span>
<span class="go">INFO [step step2] completed skipped</span>
<span class="go">ERROR [workflow ] Cannot collect workflow output: All sources for &#39;out1&#39; are null</span>
<span class="go">INFO [workflow ] completed permanentFail</span>
<span class="go">WARNING Final process status is permanentFail</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="expression-tool.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">上一页</p>
        <p class="prev-next-title"><span class="section-number">2.9. </span>表达式工具</p>
      </div>
    </a>
    <a class="right-next"
       href="operations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">下一页</p>
        <p class="prev-next-title"><span class="section-number">2.11. </span>抽象操作</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#writing-workflows">2.10.1. 编写工作流</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-workflows">2.10.2. 嵌套的工作流</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scattering-steps">2.10.3. Scattering Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-workflows">2.10.4. Conditional Workflows</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/common-workflow-language/user_guide/edit/main/src/topics/workflows.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/topics/workflows.md.txt">
      <i class="fa-solid fa-file-lines"></i> 显示源代码
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2013, CWL Project Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7创建。
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item">
<ul class="nav justify-content-center">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/blob/main/CONTRIBUTING.md">Contributing</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/">Source</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/common-workflow-language/user_guide/blob/main/CITATION.md">Cite</a>
  </li>
</ul></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>